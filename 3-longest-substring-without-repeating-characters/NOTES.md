My previous sliding window approach was incorrect but found a nice trick to solve this problem :D